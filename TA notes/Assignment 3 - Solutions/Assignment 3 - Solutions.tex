\documentclass[11pt, a4, twoside]{article}

\usepackage{
    amsmath,
    amsfonts,
    amssymb
}

\usepackage{cancel}

\usepackage{UTSolution}

\usepackage{subcaption}
\usepackage{xcolor}
\usepackage{
	tikz,
	pgfplots
}

\begin{document}
	%%%%%%%%%%%%%%%%%%% سربرگ سند %%%%%%%%%%%%%%%%%%%
	\pagestyle{empty}
	\heading
	{فرآیندهای تصادفی}
	{دکتر صفری}
	{نیمسال دوم 1403-1404}
    {توسط امیرحسین فرهمند و پوریا عصاره‌ها}
    {پاسخ تمرین سری سوم}
	%%%%%%%%%%%%%%%%%%% بخش سوالات %%%%%%%%%%%%%%%%%%%
	\begin{problem} % 1
			
	\noindent فرض کنید $X_n, n \geq 0$ یک زنجیره شاخه‌ای باشد و متغیر تصادفی مرتبط $\xi$ دارای واریانس محدود $\sigma^2$ باشد.

	\begin{enumerate}
		\item نشان دهید که
		\[
		E[X_{n+1}^2 \mid X_n = x] = x\sigma^2 + x^2\mu^2.
		\]
		
		\item از قسمت ۱ استفاده کنید تا نشان دهید که
		\[
		E_x(X_{n+1}^2) = x\mu^n\sigma^2 + \mu^2 E_x(X_n^2).
		\]
		
		\item نشان دهید که
		\[
		E_x(X_n^2) = x\sigma^2(\mu^{n-1} + \dots + \mu^{2(n-1)}) + x^2\mu^{2n}, \quad n \geq 1.
		\]
		
		\item نشان دهید که اگر در ابتدا $x$ ذره وجود داشته باشد، آنگاه برای $n \geq 1$
		\[
		\text{Var} (X_n) =
		\begin{cases}
		x\sigma^2 \mu^{n-1} \left(\frac{1 - \mu^n}{1 - \mu}\right), & \mu \neq 1, \\ 
		n x \sigma^2, & \mu = 1.
		\end{cases}
		\]
	\end{enumerate}
	\noindent \textbf{نکته مهم:} شما \textbf{نمی‌توانید} از استقرا برای اثبات این نتایج استفاده کنید.

	\end{problem}

	\begin{problem} % 2		
		ماتریس انتقال زنجیره مارکوف زیر را در نظر بگیرید:

		\[
		P =
		\begin{bmatrix}
		0.8 & 0 & 0 & 0 & 0 & 0.2 & 0 \\
		0 & 0 & 0 & 0 & 1 & 0 & 0 \\
		0.1 & 0 & 0.9 & 0 & 0 & 0 & 0 \\
		0 & 0 & 0 & 0.5 & 0 & 0 & 0.5 \\
		0 & 0.3 & 0 & 0 & 0.7 & 0 & 0 \\
		0 & 0 & 1 & 0 & 0 & 0 & 0 \\
		0 & 0.5 & 0 & 0 & 0 & 0.5 & 0
		\end{bmatrix}
		\]

		فضای حالت را $\{1, 2, \cdots, 7\}$ نام‌گذاری کنید، گراف انتقال را رسم کنید و حالت‌ها را با تجزیه فضای حالت به اجتماع مجزا از مجموعه‌های گذرا و مجموعه‌های بسته غیرقابل کاهش از حالت‌های بازگشتی طبقه‌بندی کنید.

		دلایل دقیق همان‌طور که در کلاس‌ها ارائه شده است، ضروری هستند.
	\end{problem}
	
	\begin{problem} % 3
		
		فرض کنید $x$ و $y$ حالت‌های متمایز یک زنجیره مارکوف با $d < \infty$ حالت هستند و فرض کنید $x$ به $y$ منجر می‌شود. بگذارید $n_0$ کوچک‌ترین عدد صحیح مثبت باشد به‌طوری‌که $P^{n_0}(x, y) > 0$ و بگذارید $x_1, \dots, x_{n_0-1}$ حالت‌هایی باشند به‌طوری‌که

		\[
		P(x, x_1) P(x_1, x_2) \cdots P(x_{n_0-2}, x_{n_0-1}) P(x_{n_0-1}, y) > 0.
		\]

		\begin{enumerate}
			\item نشان دهید که $x, x_1, \dots, x_{n_0-1}, y$ حالت‌های متمایز هستند.
			
			\item از قسمت (۱) استفاده کنید تا نشان دهید که $n_0 \leq d - 1$.
			
			\item نتیجه بگیرید که $P_x(T_y \leq d - 1) > 0$.
		\end{enumerate}

	\end{problem}
	
	\begin{problem} % 4
		
		زنجیره شاخه‌ای $\{X_n\}_{n=0}^{\infty}$ را با توزیع فرزندان $(p_k)_{k \geq 0}$ در نظر بگیرید. فرض کنید $X_0 = 1$.

		\begin{enumerate}
			\item فرض کنید $p_0 = 0.25$، $p_1 = 0.4$، $p_2 = 0.35$. احتمال این‌که جمعیت در نسل دوم منقرض شود (یعنی $X_2 = 0$ اما $X_1 \neq 0$) چقدر است؟ احتمال این‌که جمعیت در نهایت منقرض شود چقدر است؟
			
			\item فرض کنید $p_k = p(1 - p)^k$، $k \geq 0$، که در آن $0 < p < 1$. احتمال انقراض $\rho$ را بیابید.
		\end{enumerate}

	\end{problem}
	
	\begin{problem} % 5		
		فرض کنید $X_n, n \geq 0$ یک زنجیره مارکوف باشد که فضای حالت آن $\mathcal{S}$ زیرمجموعه‌ای از $\{0,1,2,\dots\}$ است و تابع انتقال $P$ آن به‌گونه‌ای است که

		\[
		\sum_y y P(x, y) = A x + B, \quad x \in \mathcal{S},
		\]

		برای برخی ثابت‌های $A$ و $B$.

		\begin{enumerate}
			\item نشان دهید که 
			\[
			E [X_{n+1}] = A E [X_n] + B.
			\]
			
			\item نشان دهید که اگر $A \neq 1$، آنگاه
			\[
			E [X_n] = \frac{B}{1 - A} + A^n \left( E [X_0] - \frac{B}{1 - A} \right).
			\]
			
			\item فرض کنید $X_n, n \geq 0$ زنجیره Ehrenfest روی $\{0, 1, \dots, d\}$ باشد. نشان دهید که فرض قسمت ۱ برقرار است و از آن نتیجه برای محاسبه $E_x(X_n)$ استفاده کنید.
		\end{enumerate}

	\end{problem}
	
	\begin{problem} % 6
		زنجیره‌های مارکوف زیر با ماتریس‌های انتقال داده‌شده را در نظر بگیرید:
		\[ 
		P_1(x,y) =
		\begin{array}{c@{\hspace{2pt}}c}
			& 
			\begin{array}{ccccccc}
				0 & 1 & 2 & 3 & 4 & 5 & 6
			\end{array} \\
			\begin{array}{c}
				0 \\ 1 \\ 2 \\ 3 \\ 4 \\ 5 \\ 6
			\end{array} &
			\left[
			\begin{array}{ccccccc}
				\frac{1}{2} & 0   & \frac{1}{8} & \frac{1}{4} & \frac{1}{8}   & 0   & 0   \\
				0   & 0   & 1   & 0   & 0   & 0   & 0   \\
				0   & 0   & 0   & 1   & 0   & 0   & 0   \\
				0   & 1   & 0   & 0   & 0   & 0   & 0   \\
				0   & 0   & 0   & 0   & \frac{1}{2} & 0   & \frac{1}{2} \\
				0   & 0   & 0   & 0   & \frac{1}{2} & \frac{1}{2} & 0   \\
				0   & 0   & 0   & 0   & 0   & \frac{1}{2} & \frac{1}{2}
			\end{array}
			\right]
		\end{array} \ , \qquad 
		P_1(x,y) = \begin{array}{c@{\hspace{2pt}}c}
		& 
		\begin{array}{cccccc}
			0 & 1 & 2 & 3 & 4 & 5
		\end{array} \\
		\begin{array}{c}
			0 \\ 1 \\ 2 \\ 3 \\ 4 \\ 5
		\end{array} &
		\left[
		\begin{array}{cccccc}
			\frac{1}{2} & \frac{1}{2} & 0   & 0   & 0   & 0   \\
			\frac{1}{3} & \frac{2}{3} & 0   & 0   & 0   & 0   \\
			0   & 0   & \frac{1}{8} & 0   & \frac{7}{8} & 0   \\
			\frac{1}{4} & \frac{1}{4} & 0   & \frac{1}{4} & 0   & \frac{1}{4} \\
			0   & 0   & \frac{3}{4 } & 0   & \frac{1}{4} & 0 \\
			0   & \frac{1}{5} & 0   & \frac{1}{5} & \frac{1}{5} & \frac{2}{5}
		\end{array}
		\right]
		\end{array} \]
		\begin{itemize}
		\item[(a)] تعیین کنید کدام حالت‌ها گذرا و کدام حالت‌ها بازگشتی هستند. 
		\\ {\color{blue}
		\begin{figure}[h!]
			\centering
			\begin{minipage}[b]{0.45\textwidth}
				\centering
				\begin{tikzpicture}[->, >=stealth', auto, semithick, node distance=2cm, scale=0.8, transform shape]
					\tikzstyle{state}=[circle, draw=black, thick, fill=white, minimum size=8mm]

					% Graph for P_1
					\node[state] (A) at (90:3cm) {0};
					\node[state] (B) at (40:3cm) {1};
					\node[state] (C) at (-10:3cm) {2};
					\node[state] (D) at (-60:3cm) {3};
					\node[state] (E) at (-110:3cm) {4};
					\node[state] (F) at (-160:3cm) {5};
					\node[state] (G) at (140:3cm) {6};

					\path 
					(A) edge[loop above] node{$\frac{1}{2}$} (A)
					(A) edge node{$\frac{1}{8}$} (C)
					(A) edge node{$\frac{1}{4}$} (D)
					(A) edge node{$\frac{1}{8}$} (E)
					(B) edge[loop right] node{$0$} (B)
					(B) edge node{$1$} (C)
					(C) edge node{$1$} (D)
					(D) edge node{$1$} (B)
					(E) edge[loop below] node{$\frac{1}{2}$} (E)
					(E) edge node{$\frac{1}{2}$} (G)
					(F) edge node{$\frac{1}{2}$} (E)
					(F) edge[loop left] node{$\frac{1}{2}$} (F)
					(G) edge node{$\frac{1}{2}$} (F)
					(G) edge[loop above] node{$\frac{1}{2}$} (G);

				\end{tikzpicture}
				\caption{گراف حالات $P_1$.}
			\end{minipage}
			\hfill
			\begin{subfigure}[b]{0.45\textwidth}
				\centering
				\begin{tikzpicture}[->, >=stealth', auto, semithick, node distance=2cm, scale=0.8, transform shape]
					\tikzstyle{state}=[circle, draw=black, thick, fill=white, minimum size=8mm]

					% Graph for P_2
					\node[state] (A) at (90:3cm) {0};
					\node[state] (B) at (40:3cm) {1};
					\node[state] (C) at (-10:3cm) {2};
					\node[state] (E) at (-60:3cm) {4};
					\node[state] (D) at (-110:3cm) {3};
					\node[state] (F) at (-160:3cm) {5};

					\path 
					(A) edge[loop above] node{$\frac{1}{2}$} (A)
					(A) edge node{$\frac{1}{2}$} (B)
					(B) edge[loop right] node{$\frac{2}{3}$} (B)
					(B) edge node{$\frac{1}{3}$} (A)
					(C) edge[loop below] node{$\frac{1}{8}$} (C)
					(C) edge node{$\frac{7}{8}$} (E)
					(D) edge[loop left] node{$\frac{1}{4}$} (D)
					(D) edge node{$\frac{1}{4}$} (A)
					(D) edge node{$\frac{1}{4}$} (B)
					(D) edge node{$\frac{1}{4}$} (F)
					(E) edge[loop below] node{$\frac{1}{4}$} (E)
					(E) edge node{$\frac{3}{4}$} (C)
					(F) edge[loop above] node{$\frac{2}{5}$} (F)
					(F) edge node{$\frac{1}{5}$} (B)
					(F) edge node{$\frac{1}{5}$} (D)
					(F) edge node{$\frac{1}{5}$} (E);

				\end{tikzpicture}
				\caption{گراف حالات $P_2$.}
			\end{subfigure}
		\end{figure}
		\[\begin{array}{ll|ll}
			P_1 & & P_2 & \\ \hline
			\{0\} & \textrm{گذرا}  & \{0,1\} & \textrm{بازگردنده} \\
			\{1,2,3\} & \textrm{بازگردنده} & \{2,4\} & \textrm{بازگردنده} \\
			\{4,5,6\} & \textrm{بازگردنده} & \{3,5\} & \textrm{گذرا}\\
		\end{array}\]
		از شکل گراف ها می‌توان تشخیص داد حالاتی که با ورود به آن ها خروج نخواهیم داشت قطعا بازگردنده هستند. در زنجیره اول حالت 0 به حالت 1 می‌رود و از آنجا به حالت 2 و 3 می‌رود و از آنجا به هیچ طریقی به حالت 0 بازنمی‌گردد. پس حالت 0 گذرا است. در زنجیره دوم، حالت 0 به حالت 1 می‌رود و از آنجا به حالت 0 برمی‌گردد. پس حالت 0 بازگردنده است.
		}
		\item[(b)] برای زنجیره با فضای حالت \(\{0, 1, \ldots, 6\}\)، $\rho_{0y}$ را برای $y = 0, \ldots, 6$ بیابید. \\
		{\color{blue}
		برای کلاس حالات بازگردنده میدانیم برای هر \(i,j\) در آن کلاس \(\rho_{ii} = \rho_{ij} = \rho_{ji} = 1 \) و اگر \(x \nrightarrow y\) آنگاه \(\rho_{xy} = 0\) 
		با تحلیل قدم اول یعنی :
		\begin{eqnarray*}
			\rho_{00} &=& P_{00} + \sum_{k \neq 0} P_{0k}\rho_{k0} \\
			&=& \frac{1}{2} + \frac{1}{2}\cancelto{0}{\rho_{10}} + \frac{1}{8}\cancelto{0}{\rho_{20}} + \frac{1}{4}\cancelto{0}{\rho_{30}} + \frac{1}{8}\cancelto{0}{\rho_{40}} \\
			\rho_{01} &=& \frac{1}{2}\rho_{01} + \cancelto{0}{P_{01}} + \frac{1}{8}\cancelto{1}{\rho_{21}} + \frac{1}{4}\cancelto{1}{\rho_{31}} + \frac{1}{8}\cancelto{0}{\rho_{41}} \\
			\frac{1}{2} \rho_{01} &=& \frac{3}{8} \quad \Rightarrow \quad \rho_{01} = \frac{3}{4} = \rho_{02} = \rho_{03} = \rho_{0[1]} \\
			\rho_{04} &=& \frac{1}{8} + \frac{1}{2} \rho_{04} + \cancelto{0}{\rho_{[1]4}} \quad \Rightarrow \quad \rho_{0[4]} = \rho_{05} = \rho_{06}= \frac{1}{4}
		\end{eqnarray*}
		}
		\item[(c)] برای زنجیره روی \(\{0,1 , \dots\ , 5 \}\)، $\rho_{\{0,1\}}(x)$ را برای $x = 0, \ldots, 5$ بیابید.
		\\
		{
			\color{blue} می‌دانیم 0 و 1 در یک کلاس ارتباطی هستند. \(\rho_{\{0,1\} } (x)\) ینی با شروع از \(x\) به کلاس \([1]\) برسیم. دیدیم \[ \forall i , j \in [y] \quad \rho_{xi} = \rho_{xj}\]
			\(\rho_x = \rho_{\{0,1\}}(x)\) در نظر بگیرید
			\begin{eqnarray*}
				\rho_0 &=& \rho_1 = 1 \\
				\rho_2 &=& \rho_4 = 0 \\
				\rho_3 &=& (\frac{1}{4} + \frac{1}{4}) + \frac{1}{4}\rho_3 + \frac{1}{4}\rho_3  \\
				\rho_5 &=& \frac{1}{5} + \frac{1}{5}\rho_3 + \frac{1}{5}\cancelto{0}{\rho_4} + \frac{2}{5}\rho_5 \\
				&\Rightarrow& 
				\begin{cases}
					\frac{3}{4}\rho_3 - \frac{1}{4}\rho_5  = \frac{1}{2} \\
					- \frac{1}{5}\rho_3 +\frac{3}{5}\rho_5 = \frac{1}{5}
				\end{cases} 
				\Rightarrow \quad \rho_3 = \frac{7}{8} \quad \rho_5 = \frac{5}{8}
			\end{eqnarray*} 
		} 
		\end{itemize}
	\end{problem}

	\begin{problem} % 7
    یک مؤلفه کامپیوتر دارای عمر فعال، اندازه‌گیری‌شده در واحدهای گسسته، است که یک متغیر تصادفی $T$ است، که در آن $P(T = k) = a_k$ برای $k = 1, 2, \dots$ است. فرض کنید با یک مؤلفه جدید شروع می‌کنیم و هر مؤلفه پس از خرابی با یک مؤلفه جدید جایگزین می‌شود. بگذارید $X_n$ سن مؤلفه در حال سرویس در زمان $n$ باشد. آنگاه $\{X_n\}$ یک زنجیره مارکوف موفقیت است.
    \begin{itemize}
        \item[(a)] احتمالات $p_i$ و $q_i$ را مشخص کنید. \\
        {\color{blue}
		دستگاهی که سنش \(i\) است در سرویس بعدی یا تعویض شده بوده و عمرش 1 است و  یا به سن \(i+1\) می‌رسد و می‌دانیم تا سن \(i-1\) نسوخته بوده.
		\begin{eqnarray*}
			p_i &=& P(X_{n+1} = i + 1 | X_n = i) \\
			&=& P(T > i | T > i - 1) \\
			&=& \frac{P(T > i)}{P(T > i - 1)} = \frac{1 - \sum_i^i a_i}{1-\sum_1^{i-1} a_i} = \frac{\sum^\infty_{i+1} a_i}{\sum_i^\infty a_i} \quad 1 \le i \le \infty \\
			q_i &=& P(X_{n+1} = 0 | X_n = i) \\
			&=& P(T = i | T > i - 1) \\
			&=& \frac{P(T = i)}{P(T > i - 1)} \\
			&=& \frac{\sum_{k=1}^{i} a_k}{\sum_{k=i}^{\infty} a_k} \quad 1 \le i \le \infty
		\end{eqnarray*}
		}
        \item[(b)] یک سیاست "تعویض برنامه‌ریزی‌شده" شامل تعویض مؤلفه پس از خرابی یا رسیدن به سن $N$، هرکدام که زودتر اتفاق بیفتد، است. احتمالات موفقیت $p$ و $q$ را تحت سیاست تعویض برنامه‌ریزی‌شده مشخص کنید. \\
        {\color{blue} 
		زنجیر مارکف با این حرکت متناهی می‌شود. به این صورت که 
		برای \(i < N\) احتمالات قبلی را داریم و برای \(q_N = 1\)
		\[\begin{array}{c@{\hspace{2pt}}c}
			& 
			\begin{array}{ccccc}
				1 & 2 & \cdots & \cdots & N
			\end{array} \\
			\begin{array}{c}
				1 \\ 2 \\ 3 \\ \vdots \\ N
			\end{array} &
			\left[
			\begin{array}{ccccc}
				q_1 & p_1 & 0 	& \cdots & 0    \\
				q_2 & 0   & p_2 & \cdots & 0   \\
				\vdots &  & \vdots  &    & \vdots   \\
				q_{N-1}  & 0  & \cdots   & 0   & p_{N-1} \\
				1   &    & \cdots  &   & 0  \\
			\end{array}
			\right]
		\end{array}\]
		}
    \end{itemize} 
	\end{problem}

	\begin{problem} % 8
    فرض کنید $X_n$ یک زنجیره مارکوف با احتمالات انتقال $P_{ij}$ باشد. یک «عامل تخفیف» $\beta$ با $0 < \beta < 1$ و یک تابع هزینه $c(i)$ داده شده است و می‌خواهیم هزینه کل تخفیف‌یافته مورد انتظار را از حالت $i$ محاسبه کنیم، که به‌صورت زیر تعریف می‌شود:
    
    \[
    h_i = E\left[\sum_{n=0}^{\infty} \beta^n c(X_n) \ | \ X_0 = i\right]
    \]
    
    با استفاده از تحلیل گام اول، نشان دهید که $h_i$ سیستم معادلات خطی زیر را ارضا می‌کند:
    
    \[
    \forall i \in \mathcal{S} \qquad h_i = c(i) + \beta \sum_j P_{ij} h_j
    \] 

	\end{problem}

	\begin{problem} % 9
    یک زنجیره مارکوف که در ژنتیک ظاهر می‌شود دارای حالت‌های $\{0, 1, \dots\ , 2d\}$ و تابع انتقال زیر است:
    
    \[
    P(x,y) = \binom{2d}{y}\left(\frac{x}{2d}\right)^y\left(1 - \frac{x}{2d}\right)^{2d-y}
    \]
    
    $\rho_{\{0\}}(x)$ را برای $0 < x < 2d$ بیابید.

	\end{problem}

	\begin{problem} % 10
    یک دستگاه جستجوی صفر به‌صورت زیر عمل می‌کند: اگر در زمان $n$ در حالت $j$ باشد، آنگاه در زمان $n + 1$، موقعیت آن با احتمال $\frac{1}{j}$ برابر $0$ است و موقعیت آن برابر $k$ (که $k$ یکی از حالت‌های $1, 2, \dots\ , j - 1$ است) با احتمال $\frac{2k}{j^2}$ است. زمان مورد انتظار تا اولین باری که دستگاه به صفر برسد را از حالت $m$ بیابید. \\
	{\color{blue}
	با تحلیل قدم اول :
	\begin{eqnarray*}
		E[T_0 | X_0 = 0] = e_0 &=& 0 \\
		E[T_0 | X_0 = m] = e_m &=& \sum_{k=1}^{m-1} \frac{2k}{m^2} E[T_0 | X_0 = m, X_1 = k] + \frac{1}{m} E[T_0 | X_0 = m, X_1 = 0] \\
		&=& \sum_{k=1}^{m-1} \frac{2k}{m^2} \left(e_{k} + 1 \right) + \frac{1}{m} \\
		&=& 1 + \sum_{k=1}^{m-1} \frac{2k}{m^2} e_k \\
		e_m - e_{m-1} &=& \left(1 + \frac{2}{m^2} \sum_{k=1}^{m-2} k e_k + \frac{2(m-1)}{m^2}e_{m-1}\right) - \left(1  + \frac{2}{(m-1)^2} \sum_{k=1}^{m-2} k e_k\right) \\
		e_m &=& \sum_{i=1}^m e_i - e_{i-1} \\
	\end{eqnarray*}
	}
	\end{problem}

\paragraph{\textbf{سؤال امتیازی:}} $A$ و $B$ در حال بازی با سکه هستند. در هر دور، هر دو یک سکه پرتاب می‌کنند. اگر هر دو سکه روی یک طرف بیفتند، $A$ هر دو سکه را می‌برد. در غیر این صورت، $B$ هر دو سکه را می‌برد. فرض کنید $A$ دارای $m$ سکه و $B$ دارای $n$ سکه است. مقدار مورد انتظار تعداد بازی‌ها تا زمانی که یکی از آن‌ها تمام سکه‌های خود را از دست بدهد را بیابید.


\end{document}